<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NXCore System Monitor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { 
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            font-family: 'Inter', sans-serif;
            overflow: hidden;
        }
        .status-card { 
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid rgba(59, 130, 246, 0.3);
            backdrop-filter: blur(10px);
        }
        .status-up { border-left: 4px solid #10b981; }
        .status-down { border-left: 4px solid #ef4444; }
        .status-warn { border-left: 4px solid #f59e0b; }
        .pulse { animation: pulse 2s infinite; }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body class="text-white">
    <div class="h-screen flex flex-col">
        <!-- Header -->
        <header class="bg-slate-900/50 border-b border-blue-500/30 p-4">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-600">
                        NXCore System Monitor
                    </h1>
                    <p class="text-slate-400">AeroVista Infrastructure Dashboard</p>
                </div>
                <div class="text-right">
                    <div class="text-2xl font-mono" id="current-time"></div>
                    <div class="text-sm text-slate-400" id="uptime"></div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="flex-1 grid grid-cols-12 grid-rows-6 gap-4 p-4">
            <!-- System Stats (Top Left) -->
            <div class="col-span-3 row-span-2 status-card rounded-lg p-4">
                <h3 class="text-lg font-semibold mb-4 text-blue-400">System Resources</h3>
                <div class="space-y-3">
                    <div>
                        <div class="flex justify-between text-sm">
                            <span>CPU Usage</span>
                            <span id="cpu-usage">--</span>
                        </div>
                        <div class="w-full bg-slate-700 rounded-full h-2 mt-1">
                            <div class="bg-blue-500 h-2 rounded-full transition-all duration-500" id="cpu-bar" style="width: 0%"></div>
                        </div>
                    </div>
                    <div>
                        <div class="flex justify-between text-sm">
                            <span>Memory</span>
                            <span id="memory-usage">--</span>
                        </div>
                        <div class="w-full bg-slate-700 rounded-full h-2 mt-1">
                            <div class="bg-green-500 h-2 rounded-full transition-all duration-500" id="memory-bar" style="width: 0%"></div>
                        </div>
                    </div>
                    <div>
                        <div class="flex justify-between text-sm">
                            <span>Disk</span>
                            <span id="disk-usage">--</span>
                        </div>
                        <div class="w-full bg-slate-700 rounded-full h-2 mt-1">
                            <div class="bg-yellow-500 h-2 rounded-full transition-all duration-500" id="disk-bar" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Service Status (Top Center) -->
            <div class="col-span-6 row-span-2 status-card rounded-lg p-4">
                <h3 class="text-lg font-semibold mb-4 text-green-400">Service Status</h3>
                <div class="grid grid-cols-3 gap-3" id="service-grid">
                    <!-- Services will be populated by JavaScript -->
                </div>
            </div>

            <!-- Network Stats (Top Right) -->
            <div class="col-span-3 row-span-2 status-card rounded-lg p-4">
                <h3 class="text-lg font-semibold mb-4 text-purple-400">Network</h3>
                <div class="space-y-3">
                    <div class="text-sm">
                        <div class="text-slate-400">Tailscale IP</div>
                        <div class="font-mono text-blue-400">100.115.9.61</div>
                    </div>
                    <div class="text-sm">
                        <div class="text-slate-400">Active Connections</div>
                        <div class="font-mono text-green-400" id="connections">--</div>
                    </div>
                    <div class="text-sm">
                        <div class="text-slate-400">Bandwidth</div>
                        <div class="font-mono text-yellow-400" id="bandwidth">--</div>
                    </div>
                </div>
            </div>

            <!-- Container Stats (Middle Row) -->
            <div class="col-span-6 row-span-2 status-card rounded-lg p-4">
                <h3 class="text-lg font-semibold mb-4 text-yellow-400">Container Health</h3>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <canvas id="container-chart" width="200" height="100"></canvas>
                    </div>
                    <div class="space-y-2" id="container-list">
                        <!-- Container list will be populated by JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Quick Actions (Middle Right) -->
            <div class="col-span-3 row-span-2 status-card rounded-lg p-4">
                <h3 class="text-lg font-semibold mb-4 text-red-400">Quick Actions</h3>
                <div class="space-y-2">
                    <button onclick="openService('grafana')" class="w-full bg-blue-600 hover:bg-blue-700 px-3 py-2 rounded text-sm transition-colors">
                        üìä Grafana
                    </button>
                    <button onclick="openService('prometheus')" class="w-full bg-orange-600 hover:bg-orange-700 px-3 py-2 rounded text-sm transition-colors">
                        üîç Prometheus
                    </button>
                    <button onclick="openService('portainer')" class="w-full bg-green-600 hover:bg-green-700 px-3 py-2 rounded text-sm transition-colors">
                        üê≥ Portainer
                    </button>
                    <button onclick="openService('logs')" class="w-full bg-purple-600 hover:bg-purple-700 px-3 py-2 rounded text-sm transition-colors">
                        üìã Dozzle
                    </button>
                    <button onclick="openService('status')" class="w-full bg-cyan-600 hover:bg-cyan-700 px-3 py-2 rounded text-sm transition-colors">
                        ‚è±Ô∏è Uptime Kuma
                    </button>
                </div>
            </div>

            <!-- Logs (Bottom Row) -->
            <div class="col-span-9 row-span-2 status-card rounded-lg p-4">
                <h3 class="text-lg font-semibold mb-4 text-cyan-400">Recent Activity</h3>
                <div class="bg-slate-900/50 rounded p-3 h-32 overflow-y-auto font-mono text-xs" id="activity-log">
                    <div class="text-green-400">[22:07:42] System backup completed successfully</div>
                    <div class="text-blue-400">[22:05:15] All services healthy</div>
                    <div class="text-yellow-400">[22:03:28] Grafana dashboard updated</div>
                    <div class="text-green-400">[22:01:45] New user connected to AI assistant</div>
                </div>
            </div>

            <!-- System Info (Bottom Right) -->
            <div class="col-span-3 row-span-2 status-card rounded-lg p-4">
                <h3 class="text-lg font-semibold mb-4 text-indigo-400">System Info</h3>
                <div class="space-y-2 text-sm">
                    <div>
                        <span class="text-slate-400">Hostname:</span>
                        <div class="font-mono">nxcore</div>
                    </div>
                    <div>
                        <span class="text-slate-400">OS:</span>
                        <div class="font-mono">Ubuntu 22.04</div>
                    </div>
                    <div>
                        <span class="text-slate-400">Docker:</span>
                        <div class="font-mono" id="docker-version">--</div>
                    </div>
                    <div>
                        <span class="text-slate-400">Last Update:</span>
                        <div class="font-mono" id="last-update">--</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Service URLs
        const services = {
            grafana: 'https://grafana.nxcore.tail79107c.ts.net/',
            prometheus: 'https://prometheus.nxcore.tail79107c.ts.net/',
            portainer: 'https://portainer.nxcore.tail79107c.ts.net/',
            logs: 'https://logs.nxcore.tail79107c.ts.net/',
            status: 'https://status.nxcore.tail79107c.ts.net/',
            ai: 'https://ai.nxcore.tail79107c.ts.net/',
            n8n: 'https://n8n.nxcore.tail79107c.ts.net/',
            files: 'https://files.nxcore.tail79107c.ts.net/'
        };

        // Service status data
        const serviceStatus = [
            { name: 'Traefik', status: 'up', url: 'https://traefik.nxcore.tail79107c.ts.net/' },
            { name: 'PostgreSQL', status: 'up', url: null },
            { name: 'Redis', status: 'up', url: null },
            { name: 'Authelia', status: 'up', url: 'https://auth.nxcore.tail79107c.ts.net/' },
            { name: 'Grafana', status: 'up', url: services.grafana },
            { name: 'Prometheus', status: 'up', url: services.prometheus },
            { name: 'Uptime Kuma', status: 'up', url: services.status },
            { name: 'Dozzle', status: 'up', url: services.logs },
            { name: 'cAdvisor', status: 'up', url: null }
        ];

        // Initialize dashboard
        function initDashboard() {
            updateTime();
            updateServiceGrid();
            updateContainerChart();
            updateSystemStats();
            setInterval(updateTime, 1000);
            setInterval(updateSystemStats, 5000);
            setInterval(updateServiceGrid, 10000);
        }

        // Update time display
        function updateTime() {
            const now = new Date();
            document.getElementById('current-time').textContent = now.toLocaleTimeString();
        }

        // Update service grid
        function updateServiceGrid() {
            const grid = document.getElementById('service-grid');
            grid.innerHTML = '';
            
            serviceStatus.forEach(service => {
                const statusClass = service.status === 'up' ? 'status-up' : 'status-down';
                const statusIcon = service.status === 'up' ? 'üü¢' : 'üî¥';
                
                const serviceDiv = document.createElement('div');
                serviceDiv.className = `status-card ${statusClass} rounded p-2 cursor-pointer hover:bg-slate-800/50 transition-colors`;
                serviceDiv.innerHTML = `
                    <div class="flex items-center justify-between">
                        <span class="text-sm font-medium">${service.name}</span>
                        <span class="text-lg">${statusIcon}</span>
                    </div>
                `;
                
                if (service.url) {
                    serviceDiv.onclick = () => window.open(service.url, '_blank');
                }
                
                grid.appendChild(serviceDiv);
            });
        }

        // Update container chart
        function updateContainerChart() {
            const ctx = document.getElementById('container-chart').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Running', 'Stopped', 'Unhealthy'],
                    datasets: [{
                        data: [9, 0, 1], // Update with real data
                        backgroundColor: ['#10b981', '#ef4444', '#f59e0b'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: { color: 'white', font: { size: 12 } }
                        }
                    }
                }
            });
        }

        // Update system stats
        function updateSystemStats() {
            // Simulate system stats (replace with real API calls)
            const cpu = Math.random() * 100;
            const memory = Math.random() * 100;
            const disk = Math.random() * 100;
            
            document.getElementById('cpu-usage').textContent = `${cpu.toFixed(1)}%`;
            document.getElementById('memory-usage').textContent = `${memory.toFixed(1)}%`;
            document.getElementById('disk-usage').textContent = `${disk.toFixed(1)}%`;
            
            document.getElementById('cpu-bar').style.width = `${cpu}%`;
            document.getElementById('memory-bar').style.width = `${memory}%`;
            document.getElementById('disk-bar').style.width = `${disk}%`;
            
            // Update other stats
            document.getElementById('connections').textContent = Math.floor(Math.random() * 50) + 10;
            document.getElementById('bandwidth').textContent = `${(Math.random() * 100).toFixed(1)} Mbps`;
        }

        // Open service in new tab
        function openService(serviceName) {
            if (services[serviceName]) {
                window.open(services[serviceName], '_blank');
            }
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', initDashboard);

        // Auto-refresh every 30 seconds
        setInterval(() => {
            location.reload();
        }, 30000);
    </script>
</body>
</html>
